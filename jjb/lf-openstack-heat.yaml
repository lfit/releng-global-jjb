---
- publisher:
    name: lf-stack-delete
    publishers:
      - postbuildscript:
          builders:
            - role: BOTH
              build-on:
                - ABORTED
                - FAILURE
                - SUCCESS
                - UNSTABLE
              build-steps:
                - inject:
                    properties-content: |
                      OS_CLOUD={openstack-cloud}
                      OS_STACK_NAME=$SILO-$JOB_NAME-$BUILD_NUMBER
                - config-file-provider:
                    files:
                      - file-id: clouds-yaml
                        target: '$HOME/.config/openstack/clouds.yaml'
                - shell: |
                    #!/bin/bash -l
                    echo "Deleting $OS_STACK_NAME"
                    #openstack --os-cloud "$OS_CLOUD" stack delete --yes "$OS_STACK_NAME"
          mark-unstable-if-failed: false
